import{c as k,r as n,S as us,D as js,j as s,T as Ns}from"./index-D_ZcuIAW.js";import{T as v,g as $,c as vs,f as M,b as ys,a as gs,e as Z}from"./formatters-Dp8B1lf-.js";import{C as Cs,S as Ts,T as Ss}from"./target-T5PpFNyO.js";import{H as J}from"./house-_gPa1W92.js";import{D as ks,U as K}from"./users-csqP9Dnr.js";import{P as Ms}from"./printer-Dp0kT7Bg.js";const fs=[["path",{d:"M22 12h-2.48a2 2 0 0 0-1.93 1.46l-2.35 8.36a.25.25 0 0 1-.48 0L9.24 2.18a.25.25 0 0 0-.48 0l-2.35 8.36A2 2 0 0 1 4.49 12H2",key:"169zse"}]],W=k("activity",fs);const $s=[["path",{d:"M5 21v-6",key:"1hz6c0"}],["path",{d:"M12 21V3",key:"1lcnhd"}],["path",{d:"M19 21V9",key:"unv183"}]],As=k("chart-no-axes-column",$s);const _s=[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]],Ls=k("circle-check-big",_s);const Ps=[["rect",{width:"20",height:"14",x:"2",y:"5",rx:"2",key:"ynyp8z"}],["line",{x1:"2",x2:"22",y1:"10",y2:"10",key:"1b3vmo"}]],Es=k("credit-card",Ps);const Rs=[["path",{d:"M15 14c.2-1 .7-1.7 1.5-2.5 1-.9 1.5-2.2 1.5-3.5A6 6 0 0 0 6 8c0 1 .2 2.2 1.5 3.5.7.7 1.3 1.5 1.5 2.5",key:"1gvzjb"}],["path",{d:"M9 18h6",key:"x1upvd"}],["path",{d:"M10 22h4",key:"ceow96"}]],ws=k("lightbulb",Rs);const Os=[["path",{d:"M11 6a13 13 0 0 0 8.4-2.8A1 1 0 0 1 21 4v12a1 1 0 0 1-1.6.8A13 13 0 0 0 11 14H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2z",key:"q8bfy3"}],["path",{d:"M6 14a12 12 0 0 0 2.4 7.2 2 2 0 0 0 3.2-2.4A8 8 0 0 1 10 14",key:"1853fq"}],["path",{d:"M8 6v8",key:"15ugcq"}]],Bs=k("megaphone",Os);const Fs=[["path",{d:"M11 21.73a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73z",key:"1a0edw"}],["path",{d:"M12 22V12",key:"d0xqtd"}],["polyline",{points:"3.29 7 12 12 20.71 7",key:"ousv84"}],["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}]],Ds=k("package",Fs);const Hs=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]],Is=k("user-plus",Hs),B={GOAL_STUDENTS:180,MAX_WORKLOAD_POINTS:3,MAX_CLASSES_PER_TEACHER:6},Y={type:10,level:"standard",frequency:"full",count:0,hours:16},qs=()=>{const a=n.useContext(us)?.settings||js,c=a.termMonths,t=a.maxTeachers,o=a.goalStudents,r=a.maxClassesPerTeacher,u=a.fullTimeBaseSalary,m=a.ptBaseHourlyRate,i=a.tuitionFees,p=a.fullTimeBonusMap,b=a.ptHourlyMap,j=a.frequencyMultiplier,[h,T]=n.useState(a.opsCosts),[y,g]=n.useState([{id:$(),name:"老師 A",teacherType:v.FULL_TIME,ptBasicHours:0,classes:[{id:$(),type:10,level:"standard",frequency:"full",count:8,hours:16}]},{id:$(),name:"老師 B",teacherType:v.PT,ptBasicHours:4,classes:[{id:$(),type:5,level:"advanced",frequency:"full",count:5,hours:16}]}]),F=n.useCallback((d,x)=>{const l=p[d];if(!l)return 0;const N=Math.min(x,d);return l[N]||0},[p]),P=n.useCallback((d,x)=>{const l=b[d];if(!l)return m;const N=Math.min(x,d);return l[N]||m},[b,m]),cs=n.useCallback(()=>{g(d=>{if(d.length>=t)return d;const x=d.length%26;return[...d,{id:$(),name:`老師 ${String.fromCharCode(65+x)}`,teacherType:v.FULL_TIME,ptBasicHours:0,classes:[{id:$(),...Y}]}]})},[t]),ns=n.useCallback(d=>{g(x=>x.filter(l=>l.id!==d))},[]),rs=n.useCallback((d,x,l)=>{g(N=>N.map(C=>C.id===d?{...C,[x]:l}:C))},[]),is=n.useCallback(d=>{g(x=>x.map(l=>l.id===d&&l.classes.length<r?{...l,classes:[...l.classes,{id:$(),...Y}]}:l))},[r]),ds=n.useCallback((d,x,l,N)=>{g(C=>C.map(f=>f.id!==d?f:{...f,classes:f.classes.map(A=>{if(A.id!==x)return A;let _=N;["type","count","hours"].includes(l)&&(_=N===""?0:Number(N));const S={...A,[l]:_};return(l==="type"||l==="count")&&(S.count=Math.max(0,Math.min(S.count,Number(S.type)))),l==="hours"&&(S.hours=Math.max(0,_)),S})}))},[]),ms=n.useCallback((d,x)=>{g(l=>l.map(N=>N.id===d?{...N,classes:N.classes.filter(C=>C.id!==x)}:N))},[]),hs=n.useCallback((d,x)=>{T(l=>({...l,[d]:x===""?0:Number(x)}))},[]),ps=n.useMemo(()=>{let d=0,x=0,l=0;const N=y.map(E=>{let H=0,q=0,X=0;const bs=E.classes.map(L=>{const R=j[L.frequency]||1;X+=R;const w=Number(L.type),O=Math.min(L.count,w),z=(i[L.level]?.[w]||0)*O*R/c;H+=z,l+=O;let I=0,V=0;return E.teacherType===v.FULL_TIME?O>0&&(I=F(w,O)*R):(V=P(w,O),I=V*L.hours*R),q+=I,{...L,monthlyRev:z,pay:I,hourlyRate:V,freqMultiplier:R,maxStudents:w}}),U=E.teacherType===v.FULL_TIME?u+q:E.ptBasicHours*m+q;return d+=H,x+=U,{...E,classList:bs,workload:X,tRev:H,tCost:U,tProfit:H-U}}),C=Math.ceil(l/30)*h.ptSupportBase,f=l*h.miscPerStudent,A=Math.min(35e3,l>30?(l-30)*1e3:0),_=h.rent+h.loan+h.marketing+C+f+A,S=d-x-_,G=d>0?S/d*100:0,xs=l/o*100;let D={title:"穩定觀察",content:"數據尚在累積中。建議優先填充現有班級人數，發揮規模效應。",type:"neutral"};return S<0?D={title:"虧損警訊",content:"當前處於虧損。正職底薪壓力較大，需檢視是否過多班級處於「預備期」。",type:"warning"}:G<15?D={title:"利潤偏低",content:"邊際利潤薄弱。建議增加進階班招生比例，或將支援性質班級轉為 PT。",type:"info"}:D={title:"經營卓越",content:"獲利結構非常穩健，每增加一位學員都是純利貢獻。",type:"success"},{teacherData:N,totalStud:l,totalRev:d,totalSal:x,totalOps:_,ptCost:C,misc:f,extraRent:A,net:S,progress:xs,margin:G,advice:D}},[y,h,F,P,i,c,u,m,o,j]);return{teachers:y,opsCosts:h,financial:ps,addTeacher:cs,removeTeacher:ns,updateTeacherField:rs,addClassToTeacher:is,updateClass:ds,removeClass:ms,updateOpsCost:hs,setOpsCosts:T,canAddTeacher:y.length<t,teacherCount:y.length}},Us=({financial:e,opsCosts:a})=>{const c=n.useCallback(()=>{let o=`\uFEFF老師,類型,班級級別,規模,頻率,學員數,月產值,薪資加給(獎金/PT),攤提底薪,單班真實成本,單班預估盈餘
`;e.teacherData.forEach(p=>{const b=p.teacherType==="FULL_TIME"?vs.BASE_SALARY:0,j=p.classList.length>0?b/p.classList.length:0;p.classList.forEach(h=>{const T=h.pay+j,y=h.monthlyRev-T;o+=`${p.name},${p.teacherType},${h.level==="advanced"?"進階":"標準"},${h.type}人班,${h.frequency==="full"?"全期":"單日"},${h.count},${Math.round(h.monthlyRev)},${Math.round(h.pay)},${Math.round(j)},${Math.round(T)},${Math.round(y)}
`})});const r=new Blob([o],{type:"text/csv;charset=utf-8;"}),u=URL.createObjectURL(r),m=document.createElement("a");m.href=u;const i=new Date().toISOString().split("T")[0];m.download=`營運配置分析_${i}.csv`,m.click(),URL.revokeObjectURL(u)},[e]),t=n.useCallback(()=>{window.print()},[]);return{exportCSV:c,printReport:t}},Q=n.memo(({cls:e,teacherId:a,teacherType:c,onUpdate:t,onRemove:o})=>{const r=M,u=c===v.PT,m=n.useCallback(()=>{t(a,e.id,"frequency",e.frequency==="full"?"single":"full")},[a,e.id,e.frequency,t]),i=n.useCallback(()=>{t(a,e.id,"level",e.level==="standard"?"advanced":"standard")},[a,e.id,e.level,t]),p=n.useCallback(h=>{t(a,e.id,"type",h.target.value)},[a,e.id,t]),b=n.useCallback(h=>{t(a,e.id,"count",h.target.value)},[a,e.id,t]),j=n.useCallback(h=>{t(a,e.id,"hours",h.target.value)},[a,e.id,t]);return s.jsxs("div",{className:`boss-class-config ${e.level==="advanced"?"advanced":""}`,children:[s.jsxs("div",{className:"boss-class-header",children:[s.jsxs("div",{className:"boss-class-buttons",children:[s.jsx("button",{onClick:m,className:`boss-freq-btn ${e.frequency==="single"?"single":""}`,children:e.frequency==="full"?"全期 (1.0)":"單日 (0.5)"}),s.jsx("button",{onClick:i,className:`boss-level-btn ${e.level==="advanced"?"advanced":""}`,children:e.level==="standard"?"標準課程":"進階課程"})]}),s.jsxs("span",{className:"boss-class-count-label",children:[e.count," / ",e.maxStudents,"人"]})]}),s.jsxs("div",{className:"boss-class-controls",children:[s.jsxs("select",{value:e.type,onChange:p,className:"boss-class-select",children:[s.jsx("option",{value:5,children:"5人精緻班"}),s.jsx("option",{value:10,children:"10人標準班"}),s.jsx("option",{value:15,children:"15人大型班"})]}),s.jsx("input",{type:"range",min:"0",max:e.maxStudents,value:e.count,onChange:b,className:"boss-class-slider"})]}),u&&s.jsxs("div",{className:"boss-pt-class-hours",children:[s.jsxs("span",{className:"boss-pt-hours-label",children:["每月授課時數:",s.jsx("input",{type:"number",value:e.hours,onChange:j,className:"boss-hours-input"})," hr"]}),s.jsxs("span",{className:"boss-hourly-rate",children:["$",e.hourlyRate,"/hr"]})]}),s.jsxs("div",{className:"boss-class-footer",children:[s.jsxs("span",{className:"boss-monthly-rev",children:["月均產值: $",r(e.monthlyRev)]}),s.jsx("button",{onClick:()=>o(a,e.id),className:"boss-remove-class-btn",children:"Remove"})]})]})});Q.displayName="ClassConfig";const ss=n.memo(({teacher:e,onRemove:a,onUpdateField:c,onAddClass:t,onUpdateClass:o,onRemoveClass:r})=>{const u=M,m=e.workload>B.MAX_WORKLOAD_POINTS,i=n.useCallback(b=>{c(e.id,"teacherType",b)},[e.id,c]),p=n.useCallback(b=>{const j=b.target.value===""?0:Number(b.target.value);c(e.id,"ptBasicHours",j)},[e.id,c]);return s.jsxs("div",{className:`boss-teacher-card ${m?"overloaded":""}`,children:[s.jsxs("div",{className:`boss-teacher-header ${m?"header-warning":""}`,children:[s.jsxs("div",{className:"boss-teacher-info",children:[s.jsxs("div",{className:"boss-teacher-title-row",children:[s.jsx("h3",{className:`boss-teacher-name ${m?"text-rose":""}`,children:e.name}),s.jsxs("div",{className:"boss-type-toggle",children:[s.jsx("button",{onClick:()=>i(v.FULL_TIME),className:`boss-type-btn ${e.teacherType===v.FULL_TIME?"active-ft":""}`,children:"正職"}),s.jsx("button",{onClick:()=>i(v.PT),className:`boss-type-btn ${e.teacherType===v.PT?"active-pt":""}`,children:"PT"})]})]}),s.jsxs("div",{className:"boss-teacher-badges",children:[s.jsxs("span",{className:`boss-workload-badge ${m?"badge-warning":""}`,children:["排課負荷: ",e.workload.toFixed(1)," / ",B.MAX_WORKLOAD_POINTS]}),e.teacherType===v.PT&&s.jsxs("div",{className:"boss-pt-hours",children:[s.jsx(ys,{className:"icon-xs"})," 非教學:",s.jsx("input",{type:"number",value:e.ptBasicHours,onChange:p,className:"boss-pt-hours-input"})," hr"]})]})]}),s.jsx("button",{onClick:()=>a(e.id),className:"boss-delete-btn",children:s.jsx(gs,{className:"icon-md"})})]}),s.jsxs("div",{className:"boss-teacher-classes",children:[e.classList.map(b=>s.jsx(Q,{cls:b,teacherId:e.id,teacherType:e.teacherType,onUpdate:o,onRemove:r},b.id)),e.classes&&e.classes.length<B.MAX_CLASSES_PER_TEACHER&&s.jsxs("button",{onClick:()=>t(e.id),className:"boss-add-class-btn",children:[s.jsx(Z,{className:"icon-sm"})," Add Class Config"]})]}),s.jsxs("div",{className:"boss-teacher-footer",children:[s.jsxs("div",{className:"boss-cost-row",children:[s.jsx("span",{className:"boss-cost-label",children:e.teacherType===v.PT?"PT 時薪總額":"底薪+績效獎金"}),s.jsxs("span",{className:"boss-cost-value text-rose",children:["-$",u(e.tCost)]})]}),s.jsxs("div",{className:"boss-profit-row",children:[s.jsxs("span",{className:"boss-profit-label",children:["盈餘貢獻度 ",s.jsx(Cs,{className:"icon-xs"})]}),s.jsxs("span",{className:`boss-profit-value ${e.tProfit>0?"text-emerald":"text-rose"}`,children:[e.tProfit>0?"+":"","$",u(e.tProfit)]})]})]})]})});ss.displayName="TeacherCard";const es=n.memo(({opsCosts:e,financial:a,showConfig:c,setShowConfig:t,onUpdateCost:o})=>{const r=M,u=[{label:"每月房租",key:"rent",icon:s.jsx(J,{className:"icon-xs"})},{label:"貸款償還",key:"loan",icon:s.jsx(Es,{className:"icon-xs"})},{label:"行銷推廣",key:"marketing",icon:s.jsx(Bs,{className:"icon-xs"})},{label:"PT支援基數",key:"ptSupportBase",icon:s.jsx(Is,{className:"icon-xs"})},{label:"學員雜費/人",key:"miscPerStudent",icon:s.jsx(Ds,{className:"icon-xs"})}];return s.jsxs("section",{className:"boss-ops-section",children:[s.jsxs("div",{className:"boss-ops-header",children:[s.jsxs("h2",{className:"boss-ops-title",children:[s.jsx(Ts,{className:"icon-sm"})," 營運成本核心參數"]}),s.jsx("button",{onClick:()=>t(!c),className:"boss-ops-toggle",children:c?"完成調整":"展開參數調整"})]}),c?s.jsx("div",{className:"boss-ops-grid",children:u.map(m=>s.jsxs("div",{className:"boss-ops-input-card",children:[s.jsxs("label",{className:"boss-ops-label",children:[m.icon," ",m.label]}),s.jsx("input",{type:"number",value:e[m.key],onChange:i=>o(m.key,i.target.value),className:"boss-ops-input",placeholder:"0"})]},m.key))}):s.jsxs("div",{className:"boss-ops-summary",children:[s.jsxs("div",{className:"boss-ops-summary-item",children:[s.jsx("span",{className:"boss-ops-summary-label",children:"PT支援費:"}),s.jsxs("span",{className:"boss-ops-summary-value",children:["$",r(a.ptCost)]})]}),s.jsxs("div",{className:"boss-ops-summary-item",children:[s.jsx("span",{className:"boss-ops-summary-label",children:"行政雜費:"}),s.jsxs("span",{className:"boss-ops-summary-value",children:["$",r(a.misc)]})]}),s.jsxs("div",{className:"boss-ops-summary-item",children:[s.jsx("span",{className:"boss-ops-summary-label",children:"超額房租:"}),s.jsxs("span",{className:`boss-ops-summary-value ${a.extraRent>=35e3?"text-rose":""}`,children:["$",r(a.extraRent)]})]}),s.jsxs("div",{className:"boss-ops-summary-item",children:[s.jsx("span",{className:"boss-ops-summary-label",children:"Students:"}),s.jsxs("span",{className:"boss-ops-summary-value text-blue",children:[a.totalStud," / 180"]})]})]})]})});es.displayName="OpsCostConfig";const as=n.memo(({financial:e,opsCosts:a})=>{const c=M,t=[{name:"薪資總額",val:e.totalSal,color:"#f43f5e"},{name:"營運費用",val:e.totalOps,color:"#6366f1"},{name:"預估淨利",val:Math.max(0,e.net),color:"#10b981"}],o=t.reduce((i,p)=>i+p.val,0);let r=0;const u=[{label:"老師薪資總計",val:e.totalSal,color:"bg-rose"},{label:"房租與固定費",val:a.rent+a.loan,color:"bg-indigo"},{label:"支援 PT 基數",val:e.ptCost,color:"bg-amber"},{label:"超額租金/雜費",val:e.extraRent+e.misc,color:"bg-orange"}],m=Math.max(...u.map(i=>i.val),1);return s.jsxs("div",{className:"boss-charts-grid",children:[s.jsxs("div",{className:"boss-chart-card",children:[s.jsx("h4",{className:"boss-chart-title",children:"營收結構分佈"}),s.jsxs("svg",{viewBox:"0 0 100 100",className:"boss-pie-chart",children:[t.map((i,p)=>{if(i.val<=0||o===0)return null;const b=i.val/o*360,j=r;r+=b;const h=50+40*Math.cos(j*Math.PI/180),T=50+40*Math.sin(j*Math.PI/180),y=50+40*Math.cos((j+b)*Math.PI/180),g=50+40*Math.sin((j+b)*Math.PI/180);return s.jsx("path",{d:`M 50 50 L ${h} ${T} A 40 40 0 ${b>180?1:0} 1 ${y} ${g} Z`,fill:i.color,className:"boss-pie-segment"},p)}),s.jsx("circle",{cx:"50",cy:"50",r:"25",fill:"#0f172a"})]}),s.jsx("div",{className:"boss-pie-legend",children:t.map((i,p)=>s.jsxs("div",{className:"boss-legend-item",children:[s.jsxs("div",{className:"boss-legend-label",children:[s.jsx("div",{className:"boss-legend-dot",style:{backgroundColor:i.color}}),s.jsx("span",{children:i.name})]}),s.jsxs("span",{className:"boss-legend-percent",children:[o>0?(i.val/o*100).toFixed(1):0,"%"]})]},p))})]}),s.jsxs("div",{className:"boss-chart-card",children:[s.jsx("h4",{className:"boss-chart-title",children:"損益平衡細節"}),s.jsx("div",{className:"boss-bar-chart",children:u.map((i,p)=>s.jsxs("div",{className:"boss-bar-item",children:[s.jsxs("div",{className:"boss-bar-header",children:[s.jsx("span",{children:i.label}),s.jsxs("span",{children:["$",c(i.val)]})]}),s.jsx("div",{className:"boss-bar-track",children:s.jsx("div",{className:`boss-bar-fill ${i.color}`,style:{width:`${i.val/m*100}%`}})})]},p))})]})]})});as.displayName="SVGCharts";const ts=n.memo(({financial:e,opsCosts:a})=>{const c=M,t=[{label:"人均月產值",val:e.totalStud>0?e.totalRev/e.totalStud:0,color:"text-indigo"},{label:"人均薪資支",val:e.totalStud>0?e.totalSal/e.totalStud:0,color:"text-rose"},{label:"人均營運費",val:e.totalStud>0?e.totalOps/e.totalStud:0,color:"text-amber"},{label:"人均月淨利",val:e.totalStud>0?e.net/e.totalStud:0,color:"text-emerald"}];return s.jsxs("div",{className:"boss-analysis-panel",children:[s.jsxs("div",{className:"boss-analysis-header",children:[s.jsxs("div",{children:[s.jsx("h3",{className:"boss-analysis-title",children:"Visual analytics"}),s.jsx("p",{className:"boss-analysis-subtitle",children:"Operation efficiency & revenue breakdown report"})]}),s.jsxs("div",{className:"boss-analysis-kpis",children:[s.jsxs("div",{className:"boss-kpi-card emerald",children:[s.jsx("p",{className:"boss-kpi-label",children:"NET MARGIN"}),s.jsxs("p",{className:"boss-kpi-value",children:[e.margin.toFixed(1),"%"]})]}),s.jsxs("div",{className:"boss-kpi-card blue",children:[s.jsx("p",{className:"boss-kpi-label",children:"TOTAL SIZE"}),s.jsxs("p",{className:"boss-kpi-value",children:[e.totalStud," PAX"]})]})]})]}),s.jsx(as,{financial:e,opsCosts:a}),s.jsx("div",{className:"boss-per-capita-grid",children:t.map((o,r)=>s.jsxs("div",{className:"boss-per-capita-card",children:[s.jsx("p",{className:"boss-per-capita-label",children:o.label}),s.jsxs("p",{className:`boss-per-capita-value ${o.color}`,children:["$",c(o.val)]})]},r))})]})});ts.displayName="AnalysisPanel";const ls=n.memo(({financial:e})=>{const a=M,c=t=>{switch(t){case"warning":return s.jsx(Ns,{className:"icon-md text-rose"});case"info":return s.jsx(ws,{className:"icon-md text-amber"});case"success":return s.jsx(Ls,{className:"icon-md text-emerald"});default:return s.jsx(W,{className:"icon-md text-slate"})}};return s.jsxs("div",{className:"boss-strategy-card",children:[s.jsx("div",{className:"boss-strategy-glow"}),s.jsxs("div",{className:"boss-strategy-content",children:[s.jsxs("div",{className:"boss-strategy-progress",children:[s.jsx("p",{className:"boss-strategy-label",children:"Goal completion progress"}),s.jsxs("h3",{className:"boss-strategy-percent",children:[e.progress.toFixed(0),s.jsx("span",{className:"boss-strategy-percent-sign",children:"%"})]}),s.jsxs("div",{className:"boss-strategy-students",children:[s.jsx(W,{className:"icon-sm text-emerald animate-pulse"}),"School Scale: ",e.totalStud," students"]})]}),s.jsxs("div",{className:"boss-strategy-details",children:[s.jsxs("div",{className:"boss-advice-box",children:[s.jsxs("div",{className:"boss-advice-header",children:[c(e.advice.type),s.jsx("h4",{children:"Operation intelligence guidance"})]}),s.jsxs("p",{className:"boss-advice-content",children:["「",e.advice.content,"」"]})]}),s.jsxs("div",{className:"boss-stats-row",children:[s.jsxs("div",{className:"boss-stat-item",children:[s.jsx("p",{className:"boss-stat-label",children:"Total Salary"}),s.jsxs("p",{className:"boss-stat-value",children:["-$",a(e.totalSal)]})]}),s.jsxs("div",{className:"boss-stat-item bordered",children:[s.jsx("p",{className:"boss-stat-label",children:"Op Expenses"}),s.jsxs("p",{className:"boss-stat-value",children:["-$",a(e.totalOps)]})]}),s.jsxs("div",{className:"boss-stat-item bordered",children:[s.jsx("p",{className:"boss-stat-label",children:"Margin rate"}),s.jsxs("p",{className:"boss-stat-value text-indigo",children:[e.margin.toFixed(1),"%"]})]}),s.jsxs("div",{className:"boss-stat-highlight",children:[s.jsx("p",{className:"boss-stat-label",children:"Net Profit"}),s.jsxs("p",{className:"boss-stat-value",children:["$",a(e.net)]})]})]})]})]})]})});ls.displayName="StrategyAdvice";const os=n.memo(({financial:e,opsCosts:a})=>{const c=M;return s.jsxs("div",{className:"boss-print-report",children:[s.jsxs("div",{className:"boss-print-header",children:[s.jsx("h1",{children:"營運配置損益報告書"}),s.jsxs("p",{children:["日期: ",new Date().toLocaleDateString()]})]}),s.jsxs("div",{className:"boss-print-summary",children:[s.jsxs("div",{className:"boss-print-section",children:[s.jsx("h2",{children:"全校財務摘要"}),s.jsxs("div",{className:"boss-print-rows",children:[s.jsxs("div",{className:"boss-print-row",children:[s.jsx("span",{children:"總預估月營收:"}),s.jsxs("span",{children:["$",c(e.totalRev)]})]}),s.jsxs("div",{className:"boss-print-row",children:[s.jsx("span",{children:"老師總薪資支出:"}),s.jsxs("span",{children:["-$",c(e.totalSal)]})]}),s.jsxs("div",{className:"boss-print-row",children:[s.jsx("span",{children:"固定營運支出:"}),s.jsxs("span",{children:["-$",c(a.rent+a.loan+a.marketing)]})]}),s.jsxs("div",{className:"boss-print-row",children:[s.jsx("span",{children:"變動/浮動支出:"}),s.jsxs("span",{children:["-$",c(e.ptCost+e.misc+e.extraRent)]})]}),s.jsxs("div",{className:"boss-print-row total",children:[s.jsx("span",{children:"最終月盈餘預估:"}),s.jsxs("span",{children:["$",c(e.net)]})]})]})]}),s.jsxs("div",{className:"boss-print-section",children:[s.jsx("h2",{children:"規模績效指標"}),s.jsxs("div",{className:"boss-print-rows",children:[s.jsxs("div",{className:"boss-print-row",children:[s.jsx("span",{children:"目前招生總人數:"}),s.jsxs("span",{children:[e.totalStud," 人"]})]}),s.jsxs("div",{className:"boss-print-row",children:[s.jsxs("span",{children:["目標達成率 (",B.GOAL_STUDENTS,"人):"]}),s.jsxs("span",{children:[e.progress.toFixed(1),"%"]})]}),s.jsxs("div",{className:"boss-print-row",children:[s.jsx("span",{children:"平均淨利潤率:"}),s.jsxs("span",{children:[e.margin.toFixed(1),"%"]})]}),s.jsxs("div",{className:"boss-print-row",children:[s.jsx("span",{children:"人均月淨利貢獻:"}),s.jsxs("span",{children:["$",c(e.totalStud>0?e.net/e.totalStud:0)]})]})]})]})]}),s.jsxs("table",{className:"boss-print-table",children:[s.jsx("thead",{children:s.jsxs("tr",{children:[s.jsx("th",{children:"師資姓名/類別"}),s.jsx("th",{children:"課程規模明細"}),s.jsx("th",{children:"實際人數"}),s.jsx("th",{children:"預估貢獻"})]})}),s.jsx("tbody",{children:e.teacherData.map(t=>s.jsxs("tr",{children:[s.jsxs("td",{children:[t.name," ",s.jsxs("span",{className:"boss-print-type",children:["(",t.teacherType,")"]})]}),s.jsx("td",{children:t.classList.map(o=>s.jsxs("div",{children:["• ",o.level==="advanced"?"[進階]":"[標準]"," ",o.type,"人班 (",o.frequency==="single"?"單日":"全期",")"]},o.id))}),s.jsxs("td",{className:"center",children:[t.classList.reduce((o,r)=>o+r.count,0)," 人"]}),s.jsxs("td",{className:"right",children:["$",c(t.tProfit)]})]},t.id))})]}),s.jsx("p",{className:"boss-print-footer",children:"Management Confidential • operation lab v3.2 • generated by system automated logic"})]})});os.displayName="BossPrintReport";const Vs=()=>{const[e,a]=n.useState("dashboard"),[c,t]=n.useState(!1),{opsCosts:o,financial:r,addTeacher:u,removeTeacher:m,updateTeacherField:i,addClassToTeacher:p,updateClass:b,removeClass:j,updateOpsCost:h,canAddTeacher:T}=qs(),{exportCSV:y,printReport:g}=Us({financial:r,opsCosts:o}),F=M;return s.jsxs("div",{className:"boss-container",children:[s.jsx("header",{className:"boss-header no-print",children:s.jsxs("div",{className:"boss-header-content",children:[s.jsxs("div",{className:"boss-header-title",children:[s.jsx("a",{href:"/",className:"text-slate-400 hover:text-indigo-600 transition-colors flex items-center mr-2",title:"回首頁",children:s.jsx(J,{className:"icon-md"})}),s.jsx("div",{className:"boss-header-icon",children:s.jsx(Ss,{className:"icon-md"})}),s.jsxs("div",{children:[s.jsx("h1",{children:"Business Intelligence"}),s.jsxs("div",{className:"boss-progress-bar",children:[s.jsx("div",{className:"boss-progress-track",children:s.jsx("div",{className:"boss-progress-fill",style:{width:`${Math.min(100,r.progress)}%`}})}),s.jsxs("span",{className:"boss-progress-text",children:["目標進度: ",r.progress.toFixed(1),"%"]})]})]})]}),s.jsxs("div",{className:"boss-header-actions",children:[s.jsxs("div",{className:"boss-net-preview",children:[s.jsx("p",{className:"boss-net-label",children:"當前預估淨利"}),s.jsxs("p",{className:`boss-net-value ${r.net>=0?"text-emerald":"text-rose"}`,children:["$",F(r.net)]})]}),s.jsx("button",{onClick:y,className:"boss-action-btn",title:"匯出 CSV",children:s.jsx(ks,{className:"icon-md"})}),s.jsx("button",{onClick:g,className:"boss-action-btn primary",title:"列印 PDF",children:s.jsx(Ms,{className:"icon-md"})})]})]})}),s.jsx(os,{financial:r,opsCosts:o}),s.jsxs("main",{className:"boss-main no-print",children:[s.jsx("div",{className:"boss-tabs",children:s.jsxs("div",{className:"boss-tab-group",children:[s.jsxs("button",{onClick:()=>a("dashboard"),className:`boss-tab ${e==="dashboard"?"active":""}`,children:[s.jsx(K,{className:"icon-sm"})," 營運看板"]}),s.jsxs("button",{onClick:()=>a("analysis"),className:`boss-tab ${e==="analysis"?"active":""}`,children:[s.jsx(As,{className:"icon-sm"})," 數據分析"]})]})}),e==="dashboard"?s.jsxs("div",{className:"boss-dashboard-content",children:[s.jsx(es,{opsCosts:o,financial:r,showConfig:c,setShowConfig:t,onUpdateCost:h}),s.jsxs("section",{className:"boss-faculty-section",children:[s.jsxs("div",{className:"boss-faculty-header",children:[s.jsxs("div",{children:[s.jsxs("h2",{className:"boss-faculty-title",children:[s.jsx(K,{className:"icon-md text-indigo"})," Faculty matrix"]}),s.jsxs("p",{className:"boss-faculty-subtitle",children:["Ideal capacity: ",B.MAX_WORKLOAD_POINTS," points. RED alerts triggered on overload."]})]}),s.jsxs("button",{onClick:u,disabled:!T,className:"boss-add-teacher-btn",children:[s.jsx(Z,{className:"icon-sm"})," 新聘師資"]})]}),s.jsx("div",{className:"boss-teacher-grid",children:r.teacherData.map(P=>s.jsx(ss,{teacher:P,onRemove:m,onUpdateField:i,onAddClass:p,onUpdateClass:b,onRemoveClass:j},P.id))})]})]}):s.jsx(ts,{financial:r,opsCosts:o}),s.jsx(ls,{financial:r})]}),s.jsx("footer",{className:"boss-footer no-print",children:s.jsx("span",{children:"Operation Intelligence System • Enterprise Deployment v3.5 • data logic validated • CSV & PDF enabled"})})]})},Qs=()=>s.jsx(Vs,{});export{Qs as default};
